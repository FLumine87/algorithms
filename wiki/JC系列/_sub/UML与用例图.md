## 要点二：掌握用例图的绘制方法（详细版+示意图）

### 一、用例图核心概念

**本质**：用例图是**外部视角**的功能模型，它定义了系统"黑盒"应该提供哪些服务。

### 二、基本元素详解

#### 1. 系统边界（System Boundary）
```
┌──────────────────┐
│  图书馆管理系统   │ ← 系统名称
│                  │
│  ┌──────┐       │
│  │ 借书 │       │
│  └──────┘       │
│                  │
│  ┌──────┐       │
│  │ 还书 │       │
│  └──────┘       │
└──────────────────┘
```
**作用**：明确划分系统内外的界限，避免范围蔓延。

#### 2. 参与者（Actor）
```
    ○
   /│\   ← 小人图标
   / \
  读者
  (参与者名称)
```
**关键特性**：
- 是**角色**而非具体用户：如"管理员"而非"张三"
- 可以是**人、外部系统、硬件设备**：如"银行支付系统"
- 可以**泛化**（继承关系）

#### 3. 用例（Use Case）
```
   ┌──────┐
   │ 借书 │ ← 椭圆形
   └──────┘
```
**命名规则**：
- **动宾结构**：查询图书、缴纳罚款
- **明确的价值**：一个用例应为一个参与者完成一个有价值的目标
- **粒度适中**：不宜过大（如"管理图书馆"）或过小（如"输入密码"）

### 三、核心关系类型（带示意图）

#### 1. 关联关系（Association）
```
    读者      ───────────>   ┌──────┐
    (参与者)                 │ 借书 │
                            └──────┘
```
**含义**：参与者与用例之间的通信路径。

#### 2. 包含关系（«include»）★高频考点
```
                            ┌──────┐
     读者 ─────┐            │ 借书 │
               │           └───┬───┘
               │               │ «include»
               │               ↓
               │          ┌─────────┐
               └────────> │验证身份│
                          └─────────┘
```
**更清晰的布局**：
```
┌─────────────────────────────────────┐
│        图书馆管理系统                │
│                                      │
│  借书 ──────«include»────> 验证身份  │
│    ▲                                │
│    │                                │
└────┼────────────────────────────────┘
     │
     │
    读者
```

**关键特点**：
- **必须执行**：执行基用例时，被包含用例**必须**执行
- **公共功能提取**：避免重复描述
- **箭头指向**：指向被包含用例（子功能）

**实例**：
- `借书` `«include»` `验证读者身份`
- `还书` `«include»` `验证读者身份`
- `预订图书` `«include»` `查询书目`

#### 3. 扩展关系（«extend»）★高频考点
```
                          ┌──────┐
     读者 ────────┐       │ 借书 │
                  │      └───┬───┘
                  │          │
                  │          │ «extend»
                  │          ↓
                  │    ┌───────────┐
                  └──> │缴纳超重罚金│
                       └───────────┘
        （条件：借阅超重）
```

**扩展点说明**：
```
           ┌──────┐
           │ 借书 │
           └───┬──┘
               │
扩展点：超重处理 │ «extend»
               ↓
       ┌───────────┐
       │缴纳超重罚金│
       └───────────┘
```

**关键特点**：
- **条件执行**：只在特定条件满足时才执行
- **可选功能**：扩展用例是基用例的**可选**增强
- **箭头指向**：指向被扩展的基用例

**常见扩展条件**：
- 异常情况：`登录` `«extend»` `找回密码`（当忘记密码时）
- 特殊业务：`购物` `«extend»` `使用优惠券`（当有优惠券时）
- 权限升级：`普通查询` `«extend»` `高级分析`（当用户是VIP时）

#### 4. 泛化关系（Generalization）
**参与者泛化**：
```
       ┌──────┐
       │ 用户 │（父参与者）
       └───┬──┘
           △
          / \
         /   \
        /     \
    ┌────┐ ┌──────┐
    │读者│ │管理员│（子参与者）
    └────┘ └──────┘
```
- 子参与者**继承**父参与者的所有用例
- 子参与者可能有**额外**的用例

**用例泛化**：
```
       ┌──────┐
       │ 支付 │（父用例）
       └───┬──┘
           △
          / \
         /   \
        /     \
    ┌────┐ ┌────┐
    │现金│ │刷卡│（子用例）
    │支付│ │支付│
    └────┘ └────┘
```
- 子用例是父用例的**特化版本**
- 通常出现在有多种实现方式时

### 四、完整用例图示例

#### 图书馆管理系统用例图
```
┌──────────────────────────────────────────────────┐
│            图书馆管理系统                          │
│                                                  │
│    ┌──────┐        «include»        ┌──────┐    │
│    │ 借书 ├─────────────────────────>│验证  │    │
│    └──┬───┘                         │身份  │    │
│       │                             └──────┘    │
│       │ «extend»                                │
│       ↓                                         │
│    ┌──────┐                                     │
│    │缴纳   │                                     │
│    │超重罚金│                                     │
│    └──────┘                                     │
│                                                  │
│    ┌──────┐        «include»                    │
│    │ 还书 ├─────────────────────────┐            │
│    └──┬───┘                         │            │
│       │                             │            │
│       │ «extend»                    │            │
│       ↓                             │            │
│    ┌──────┐                         │            │
│    │缴纳   │                         │            │
│    │逾期罚金│                         │            │
│    └──────┘                         │            │
│                                                  │
│    ┌──────┐                                     │
│    │查询   │                                     │
│    │书目  │                                     │
│    └──────┘                                     │
│          △                                      │
│          │ 泛化                                 │
│          │                                      │
│    ┌──────┐                                     │
│    │高级   │                                     │
│    │搜索  │                                     │
│    └──────┘                                     │
└──────────────────────────────────────────────────┘
     │          │          │           │
     │          │          │           │
    ┌┴┐        ┌┴┐        ┌┴┐        ┌─┴─┐
    │读│        │图│        │系│        │外│
    │者│        │书│        │统│        │部│
    │  │        │管│        │管│        │支│
    │  │        │理│        │理│        │付│
    │  │        │员│        │员│        │系│
    └──┘        └──┘        └──┘        └─┬─┘
                                         │
                                      ┌─────┐
                                      │银行 │
                                      │系统 │
                                      └─────┘
```

### 五、考试常见题型与答题技巧

#### 题型1：根据描述绘制用例图
**题目示例**：
> "在在线购物系统中，顾客可以浏览商品、搜索商品、购买商品。购买商品时，必须先登录系统。如果顾客是VIP会员，还可以使用积分抵扣。系统管理员可以管理商品信息。"

**分析步骤**：
1. **识别参与者**：顾客、VIP会员（顾客的特化）、系统管理员
2. **识别用例**：
   - 顾客：浏览商品、搜索商品、购买商品、登录
   - 管理员：管理商品信息
3. **分析关系**：
   - 购买商品 `«include»` 登录（必须登录才能购买）
   - 购买商品 `«extend»` 使用积分抵扣（如果是VIP会员）
   - VIP会员 泛化 顾客
4. **绘制图形**

#### 题型2：辨析包含与扩展关系
**记忆口诀**：
```
包含：基用例不带被包含用例不完整（必须）
扩展：基用例没有扩展用例也能运行（可选）

包含：无条件的"包含"（如：做饭必须包含准备食材）
扩展：有条件的"增强"（如：做饭可以扩展为做豪华大餐）
```

#### 题型3：找出用例图中的错误
**常见错误**：
1. 参与者之间用关联线连接（错误！参与者之间用泛化）
2. 用例之间直接用实线连接（错误！用例之间只能用包含、扩展、泛化）
3. 扩展关系的箭头画反了（必须指向被扩展的基用例）
4. 没有标注关系类型（«include»或«extend»）

### 六、实用绘图规范（考试时注意）

1. **布局美观**：
   - 参与者在系统边界外
   - 用例在系统边界内
   - 重要用例放在左上角

2. **命名规范**：
   - 参与者：名词（角色名）
   - 用例：动词+名词（动宾结构）

3. **关系标注**：
   - 包含/扩展必须写双尖括号：`«include»`、`«extend»`
   - 扩展条件可写在关系线旁


# UML类图关系对比表

| 关系类型                  | UML符号                     | 语法/代码表现                                                                          | 典型示例                                           |
| --------------------- | ------------------------- | -------------------------------------------------------------------------------- | ---------------------------------------------- |
| **依赖 Dependency**     | `----->` （虚线箭头）           | **局部变量、方法参数、方法返回值、静态方法调用**<br>`class A { void f(B b) {...} }`                    | `顾客` ----> `收据`<br>（结账时生成）                     |
| **关联 Association**    | `-----` 或 `----->`（实线/箭头） | **成员变量**<br>`class A { private B b; }`                                           | `学生` —— `课程`<br>`顾客` -> `购物车`                  |
| **聚合 Aggregation**    | `◇-----` （空心菱形）           | 同关联，但**构造和销毁独立**<br>`class Team { private List<Member> members; }`               | `汽车` ◇—— `轮胎`<br>`团队` ◇—— `成员`                 |
| **组合 Composition**    | `◆-----` （实心菱形）           | 同关联，且**生命周期绑定**<br>`class Window { private Frame frame; }`<br>（Window构造时创建Frame） | `公司` ◆—— `部门`<br>`订单` ◆—— `订单项`                |
| **泛化 Generalization** | `────▷` （实线空心三角）          | **extends**<br>`class B extends A { ... }`                                       | `学生` ——▷ `人`<br>`SUV` ——▷ `汽车`                 |
| **实现 Realization**    | `- - -▷` （虚线空心三角）         | **implements**<br>`class C implements Interface { ... }`                         | `PDF导出` - -▷ `导出接口`<br>`ArrayList` - -▷ `List` |
