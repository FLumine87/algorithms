## 基本概念
#### 一、有限状态机的基本概念

- **定义**：有限状态机是一种计算模型，可通过硬件或软件实现，用于模拟时序逻辑和部分计算机程序。
- **核心特性**
    - **有限状态**：FSM 包含有限个状态，且任一时刻仅能处于一个状态。
    - **状态转移**：状态的变化依赖于当前状态和输入数据。若输入有效，FSM 最终会终止于接受状态。
    - **转移规则**：状态转移由明确的规则控制，规则定义了在特定条件下 FSM 的行为。
#### 四、时序电路与有限状态机的关系

- **时序电路的特性**：应用于需要 “状态记忆” 的场景，下一状态由当前状态和输入共同决定，需结合组合逻辑和时序逻辑。
- **FSM 对时序电路的描述**：FSM 接收输入和当前状态，生成输出和新状态，由组合逻辑和时序逻辑组件构成以维护状态信息。

#### 五、有限状态机的两种模型

- **Mealy 机**：输出是当前状态和当前输入的函数。
- **Moore 机**：输出仅依赖于当前状态。
- **对比**：两者功能等价，区别在于输出的决定因素不同。Moore 机的输出更稳定（仅由状态决定），而 Mealy 机的输出可能随输入即时变化。

#### 六、状态机的形式化表示

- **状态表（State Table）**：输入为状态和输入变量，输出为下一状态，类似真值表。
- **输出表（Output Table）**：输入为状态和输入变量，输出为输出变量。
- **状态方程（State Equation）**：用逻辑表达式描述下一状态与当前状态、输入的关系，可通过卡诺图（K-map）化简得到规范表达式。

---
## [[摩尔机]] 主要是懒得总结了
---
## 米利机（Mealy Machine）
#### 一、米利机的核心特性

- **定义**：米利机是有限状态机（FSM）的一种，其输出同时依赖于当前状态和输入信号6。
- **与摩尔机的区别**：摩尔机的输出仅由状态决定，而米利机的输出会随输入实时变化，更适合处理输入序列相关场景6。

#### 二、模式检测器（Pattern Detector）案例

##### 1. **功能需求**

- 输入：比特流（如 0 1 1 0 1 0 1 1 0 0…）4。
- 目标：检测特定模式（如 “101”），检测到完整模式时输出 1，否则输出 01。
- 关键逻辑：需记忆历史输入，跟踪前两位输入以判断当前位是否构成完整模式2。

##### 2. **状态转移图设计**

- **状态定义**：
    - $S_a$：初始状态（未接收到有效前缀）。
    - $S_b$：接收到前缀 “1”（模式第一位）。
    - $S_c$：接收到前缀 “10”（模式前两位）。
- **转移与输出标注**：
    - 边标注为 “输入 / 输出”（如 “1/0” 表示输入 1 时输出 0）6。
    - 示例：
        - $S_a$输入 0 时保持$S_a$，输出 0；输入 1 时转移至$S_b$，输出 0。
        - $S_b$输入 0 时转移至$S_c$，输出 0；输入 1 时保持$S_b$，输出 0。
        - $S_c$输入 1 时转移至$S_b$，输出 1（检测到 “101”）；输入 0 时转移至$S_a$，输出 07。

---
## 亚稳定状态
### 一、D 触发器基础行为（图 1）

- **核心逻辑**：时钟边沿（上升沿 / 下降沿，图中为上升沿）触发时，D 端输入值被 “复制” 到 Q 端；两次时钟边沿间，Q 保持前一次采样值不变。
- **波形含义**：CLK 为时钟信号，D 为输入、Q 为输出；时钟边沿触发后，Q 跟随 D 的稳定值（$D_i$）更新。

### 二、输入稳定性要求（图 2）

- **关键规则**：时钟采样（复制 D→Q）时，D 必须保持稳定。
- **波形警示**：若 D 在时钟边沿附近变化（图中 “交叉线” 区域），会破坏采样条件，可能引发**亚稳态**（后续重点）。

### 三、亚稳态问题（图 3）

- **触发条件**：时钟采样瞬间，D 处于变化状态（未稳定在 0/1）。
- **现象**：触发器输出 Q 卡在 0 和 1 之间的不确定电平，最终随机稳定到 0 或 1（非预期结果）。
- **风险**：亚稳态会传播到后续电路，导致逻辑错误，是时序设计的核心风险之一。

### 四、建立时间与保持时间（图 4）

- **建立时间（$t_{setup}$）**：时钟边沿前，D 必须提前稳定的最小时间（避免采样时 D 变化）。
- **保持时间（$t_{hold}$）**：时钟边沿后，D 必须继续稳定的最小时间（确保采样值可靠锁存）。
- **约束本质**：定义 D 端的 “稳定窗口”，保证时钟采样时 D 值有效。

### 五、时钟到 Q 的延迟参数（图 5）

- **污染延迟（$t_{ccq}$）**：时钟边沿后，Q 开始变化的最早时间（输出进入不稳定状态的起点）。
- **传播延迟（$t_{pcq}$）**：时钟边沿后，Q 稳定到最终值的最晚时间（输出完全可靠的终点）。
- **工程意义**：决定了 Q 端信号何时能被后续电路安全采样，影响系统最高工作频率。

---
## [[时序电路定时分析]]